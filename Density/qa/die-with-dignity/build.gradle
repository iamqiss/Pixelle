/*
 * SPDX-License-Identifier: Apache-2.0
 *
 * The Density Contributors require contributions made to
 * this file be licensed under the Apache-2.0 license or a
 * compatible open source license.
 *
 * Modifications Copyright Density Contributors. See
 * GitHub history for details.
 */

import org.density.gradle.info.BuildParams
import org.density.gradle.util.GradleUtils

apply plugin: 'density.java-rest-test'
apply plugin: 'density.densityplugin'

densityplugin {
  description = 'Die with dignity plugin'
  classname = 'org.density.DieWithDignityPlugin'
}

// let the javaRestTest see the classpath of main
GradleUtils.extendSourceSet(project, "main", "javaRestTest", javaRestTest)

javaRestTest {
  systemProperty 'tests.security.manager', 'false'
  systemProperty 'tests.system_call_filter', 'false'
  nonInputProperties.systemProperty 'log', "${-> testClusters.javaRestTest.singleNode().getServerLog()}"
  systemProperty 'runtime.java.home', BuildParams.runtimeJavaHome
}

testClusters.javaRestTest {
  systemProperty "die.with.dignity.test", "whatever"
}

test.enabled = false
